<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Sudo Misconfigurations - Rare Code Code</title>

    <meta name="description"
        content="Learn how to exploit sudo misconfigurations for privilege escalation in Linux. A step-by-step guide with real-world examples, practical exploitation techniques, and detailed command walkthroughs to gain root access.">

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <script src="/js/main.js" defer></script>
    <script src="/js/sidebar.js" defer></script>
</head>


<body>

    <div id="navbar-placeholder"></div>

    <main class="d-lg-flex flex-nowrap d-block">

        <div id="sidebar-placeholder"></div>

        <div class="content p-4">
            <h1 class="mt-4">Sudo Misconfigurations</h1>

            <h2 class="mt-5">Sudo Misconfigurations</h2>
            <p>
                <b>Sudo</b> is a command that allows a user to run specific programs as the superuser (root) or another
                user.
                What a user can do with sudo is controlled by the <code>/etc/sudoers</code> file.
                If this file is not configured properly (called a misconfiguration), it might let a user run dangerous
                commands
                or even gain full root access without needing a password.
            </p>

            <h3 class="mt-4">How to Check What You Can Run with Sudo</h3>
            <p>
                To see what commands the current user is allowed to run using sudo, type:
            </p>
            <pre><code>$ sudo -l</code></pre>
            <p>
                This will list all the commands that the user can run with sudo.
                If a command has <b>(NOPASSWD)</b> next to it, it means the user can run it <b>without entering a
                    password</b>.
            </p>
            <p>
                If any of those commands can be used to open a shell (like <code>vim</code>, <code>less</code>,
                <code>python</code>, etc.),
                then the user may be able to become root or access sensitive parts of the system.
            </p>

            <h3 class="mt-5">Practical Example: Exploiting Sudo Misconfiguration</h3>
            <p>Let’s look at a real‑world scenario where sudo is misconfigured, allowing a low‑privileged user to
                escalate to root.</p>

            <h4 class="mt-4">Step 1: Listing Allowed Commands</h4>
            <p>Run the following to see which commands you can run as root:</p>
            <pre><code>$ sudo -l</code></pre>
            <!-- Screenshot of the sudo -l output -->
            <p>
                <img src="images/sudo-l-output.png" alt="Output of sudo -l showing allowed commands" style="max-width: 100%;" />
            </p>

            <h4 class="mt-4">Step 2: Using <code>find</code> to Spawn a Root Shell</h4>
            <p>Since <code>/usr/bin/find</code> is allowed without a password, you can do:</p>
            <pre><code>$ sudo find . -exec /bin/sh \; -quit</code></pre>
            <!-- Screenshot of root shell via find -exec -->
            <p>
                <img src="images/find-exec-shell.png" alt="Using find -exec to spawn a root shell" style="max-width: 100%;" />
            </p>

            <h4 class="mt-4">What <code>NOPASSWD</code> Means</h4>
            <p>
                When a command is tagged with <code>NOPASSWD</code> in <code>/etc/sudoers</code>, you can invoke that
                command with <code>sudo</code> without being prompted for your password.
                This is dangerous if the allowed command can be abused to execute arbitrary code or drop into a shell
                (as <code>find -exec</code> does).
            </p>
            <p>
                <strong>Key takeaway:</strong> Only use <code>NOPASSWD</code> for truly non‑interactive, safe binaries.
                Avoid it for any tool that can spawn an editor, shell, or otherwise let you escape to an unrestricted
                prompt.
            </p>


            <h4 class="mt-4">Conclusion</h4>
            <p>
                Misconfigured <code>sudo</code> permissions can be just as dangerous as SUID binaries. It’s crucial to
                limit which binaries are allowed
                with <code>sudo</code> access, especially those that allow shell command execution.
            </p>

        </div>

    </main>

    <div id="footer-placeholder"></div>
</body>

</html>
